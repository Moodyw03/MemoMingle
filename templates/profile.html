<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Cloud Diary - My Profile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body class="container">
    <!-- Success -->
    {% if success %}
    <div id="success">
      <p>{{ success }}</p>
    </div>
    {% endif %}

    <!-- Error -->
    {% if error %}
    <div id="error">
      <p>{{ error }}</p>
    </div>
    {% endif %}

    <!-- NAV -->
    <nav class="notes__nav">
      <div class="written-note">
        <a href="{{ url_for('note.get_notes') }}" title="My Cloud Diary">
          <img
            class="memologo"
            src="{{ url_for('static', filename='images/myclouddiary.png') }}"
            alt="My Cloud Diary logo"
          />
        </a>
        <a
          class="memo"
          href="{{ url_for('note.get_notes') }}"
          title="My Cloud Diary"
        >
          <h2>
            <strong class="">My Cloud Diary</strong>
            <span class="slogan">
              <span>Capture your thoughts.</span>
              <span>Keep them forever!</span>
            </span>
          </h2>
        </a>
      </div>

      <!-- Back to Notes Button -->
      <div class="profile-nav-actions">
        <a href="{{ url_for('note.get_notes') }}" class="button">Back to Notes</a>
      </div>
    </nav>

    <section class="profile-container">
      <div class="profile-card">
        <h1 class="profile-title">My Profile</h1>
        
        <div class="profile-info">
          <div class="profile-details">
            <div class="profile-username">
              <strong>Username:</strong> {{ user.username }}
              {% if user.streak and user.streak > 1 %}
              <span class="streak-badge">ðŸ”¥ <span class="streak-count">{{ user.streak }}-Day Streak</span></span>
              {% endif %}
            </div>
            
            {% if achievements %}
            <div class="achievement-container">
              <h3 class="achievement-title">Your Achievements</h3>
              <div class="achievement-badges">
                {% for achievement in achievements %}
                <div class="achievement-badge {% if not achievement.unlocked %}locked{% endif %}">
                  <div class="badge-icon">{{ achievement.icon }}</div>
                  <div class="badge-name">{{ achievement.name }}</div>
                </div>
                {% endfor %}
              </div>
            </div>
            {% endif %}
            
            <h3 class="profile-subtitle">Change Password</h3>
            <form class="profile-form" action="{{ url_for('auth.profile') }}" method="post" onsubmit="return checkPasswordsProfile()">
              <div class="form-group">
                <label for="current-password">Current Password</label>
                <input type="password" id="current-password" name="current_password" required>
              </div>
              <div class="form-group">
                <label for="new-password">New Password</label>
                <input type="password" id="new-password" name="new_password" required>
              </div>
              <div class="form-group">
                <label for="confirm-new-password">Confirm New Password</label>
                <input type="password" id="confirm-new-password" name="confirm_new_password" required>
              </div>
              <div class="profile-actions">
                <button type="submit" class="update-btn">Update Password</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <!-- Session warning modal -->
    <div class="session-warning-overlay" id="sessionWarningOverlay">
      <div class="session-warning-modal">
        <h3 class="session-warning-title">Session Expiring Soon</h3>
        <p class="session-warning-message">
          Your session will expire due to inactivity in:
        </p>
        <div class="session-timer" id="sessionCountdown">1:00</div>
        <div class="session-warning-actions">
          <button class="session-continue-btn" id="continueSessionBtn">Continue Session</button>
          <button class="session-logout-btn" id="logoutNowBtn">Logout Now</button>
        </div>
      </div>
    </div>

    {% include 'footer.html' %}

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  </body>
</html> 